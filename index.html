async function pay(asset) {
    const min = { 'STARS': 5, 'TON': 0.2, 'USDT': 0.4 };
    const amount = prompt(`Montant du dépôt (${asset}) ?\nMinimum : ${min[asset]}`);
    
    if(!amount || amount < min[asset]) {
        return tg.showAlert(`Le montant doit être d'au moins ${min[asset]} ${asset}`);
    }

    const r = await fetch('/api/deposit', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({ id: userId, amount, asset })
    });
    const data = await r.json();
    if(data.success) tg.openTelegramLink(data.url);
    else tg.showAlert(data.message || "Erreur lors du dépôt.");
}

async function withdraw() {
    const asset = prompt("Que voulez-vous retirer ? (STARS / TON / USDT)").toUpperCase();
    if(!['STARS', 'TON', 'USDT'].includes(asset)) return tg.showAlert("Monnaie invalide.");

    const minW = { 'STARS': 15, 'TON': 0.7, 'USDT': 1 };
    const amount = prompt(`Montant à retirer ?\nMinimum : ${minW[asset]}`);
    
    if(!amount || amount < minW[asset]) {
        return tg.showAlert(`Le montant minimum est de ${minW[asset]} ${asset}`);
    }

    const address = prompt("Entrez votre adresse USDT (ou TON) pour recevoir vos gains :");
    if(amount && address) {
        const r = await fetch('/api/withdraw', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({ id: userId, name: userName, amount, address, asset })
        });
        const res = await r.json();
        tg.showAlert(res.message);
    }
}
